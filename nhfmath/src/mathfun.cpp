#include "nhfmath/mathfun.hpp"
#include <cstddef>
#include <cstdint>
#include <cassert>
#include <cmath>

namespace nhfMath {

const std::size_t FactorialMaxN = 20;
const std::size_t CombinationMaxN = 50;
const std::int64_t SemifactorialMinN = -1;
const std::int64_t SemifactorialMaxN = 30;


double factorial(std::size_t n) {
    assert(n <= FactorialMaxN);

    static const double factorialList[] = {
        1.0000000000000000e+00,     //  0!
        1.0000000000000000e+00,     //  1!
        2.0000000000000000e+00,     //  2!
        6.0000000000000000e+00,     //  3!
        2.4000000000000000e+01,     //  4!
        1.2000000000000000e+02,     //  5!
        7.2000000000000000e+02,     //  6!
        5.0400000000000000e+03,     //  7!
        4.0320000000000000e+04,     //  8!
        3.6288000000000000e+05,     //  9!
        3.6288000000000000e+06,     // 10!
        3.9916800000000000e+07,     // 11!
        4.7900160000000000e+08,     // 12!
        6.2270208000000000e+09,     // 13!
        8.7178291200000000e+10,     // 14!
        1.3076743680000000e+12,     // 15!
        2.0922789888000000e+13,     // 16!
        3.5568742809600000e+14,     // 17!
        6.4023737057280000e+15,     // 18!
        1.2164510040883200e+17,     // 19!
        2.4329020081766400e+18,     // 20!
    };

    return factorialList[n];
}


double combination(std::size_t n, std::size_t k) {
    assert(k <= n);
    assert(n <= CombinationMaxN);

    static const double combinationList[][51] = {
        {1.0000000000000000e+00, },
        {1.0000000000000000e+00, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 2.0000000000000000e+00, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 3.0000000000000000e+00, 3.0000000000000000e+00, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 4.0000000000000000e+00, 6.0000000000000000e+00, 4.0000000000000000e+00, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 5.0000000000000000e+00, 1.0000000000000000e+01, 1.0000000000000000e+01, 5.0000000000000000e+00, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 6.0000000000000000e+00, 1.5000000000000000e+01, 2.0000000000000000e+01, 1.5000000000000000e+01, 6.0000000000000000e+00, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 7.0000000000000000e+00, 2.1000000000000000e+01, 3.5000000000000000e+01, 3.5000000000000000e+01, 2.1000000000000000e+01, 7.0000000000000000e+00, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 8.0000000000000000e+00, 2.8000000000000000e+01, 5.6000000000000000e+01, 7.0000000000000000e+01, 5.6000000000000000e+01, 2.8000000000000000e+01, 8.0000000000000000e+00, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 9.0000000000000000e+00, 3.6000000000000000e+01, 8.4000000000000000e+01, 1.2600000000000000e+02, 1.2600000000000000e+02, 8.4000000000000000e+01, 3.6000000000000000e+01, 9.0000000000000000e+00, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 1.0000000000000000e+01, 4.5000000000000000e+01, 1.2000000000000000e+02, 2.1000000000000000e+02, 2.5200000000000000e+02, 2.1000000000000000e+02, 1.2000000000000000e+02, 4.5000000000000000e+01, 1.0000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 1.1000000000000000e+01, 5.5000000000000000e+01, 1.6500000000000000e+02, 3.3000000000000000e+02, 4.6200000000000000e+02, 4.6200000000000000e+02, 3.3000000000000000e+02, 1.6500000000000000e+02, 5.5000000000000000e+01, 1.1000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 1.2000000000000000e+01, 6.6000000000000000e+01, 2.2000000000000000e+02, 4.9500000000000000e+02, 7.9200000000000000e+02, 9.2400000000000000e+02, 7.9200000000000000e+02, 4.9500000000000000e+02, 2.2000000000000000e+02, 6.6000000000000000e+01, 1.2000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 1.3000000000000000e+01, 7.8000000000000000e+01, 2.8600000000000000e+02, 7.1500000000000000e+02, 1.2870000000000000e+03, 1.7160000000000000e+03, 1.7160000000000000e+03, 1.2870000000000000e+03, 7.1500000000000000e+02, 2.8600000000000000e+02, 7.8000000000000000e+01, 1.3000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 1.4000000000000000e+01, 9.1000000000000000e+01, 3.6400000000000000e+02, 1.0010000000000000e+03, 2.0020000000000000e+03, 3.0030000000000000e+03, 3.4320000000000000e+03, 3.0030000000000000e+03, 2.0020000000000000e+03, 1.0010000000000000e+03, 3.6400000000000000e+02, 9.1000000000000000e+01, 1.4000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 1.5000000000000000e+01, 1.0500000000000000e+02, 4.5500000000000000e+02, 1.3650000000000000e+03, 3.0030000000000000e+03, 5.0050000000000000e+03, 6.4350000000000000e+03, 6.4350000000000000e+03, 5.0050000000000000e+03, 3.0030000000000000e+03, 1.3650000000000000e+03, 4.5500000000000000e+02, 1.0500000000000000e+02, 1.5000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 1.6000000000000000e+01, 1.2000000000000000e+02, 5.6000000000000000e+02, 1.8200000000000000e+03, 4.3680000000000000e+03, 8.0080000000000000e+03, 1.1440000000000000e+04, 1.2870000000000000e+04, 1.1440000000000000e+04, 8.0080000000000000e+03, 4.3680000000000000e+03, 1.8200000000000000e+03, 5.6000000000000000e+02, 1.2000000000000000e+02, 1.6000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 1.7000000000000000e+01, 1.3600000000000000e+02, 6.8000000000000000e+02, 2.3800000000000000e+03, 6.1880000000000000e+03, 1.2376000000000000e+04, 1.9448000000000000e+04, 2.4310000000000000e+04, 2.4310000000000000e+04, 1.9448000000000000e+04, 1.2376000000000000e+04, 6.1880000000000000e+03, 2.3800000000000000e+03, 6.8000000000000000e+02, 1.3600000000000000e+02, 1.7000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 1.8000000000000000e+01, 1.5300000000000000e+02, 8.1600000000000000e+02, 3.0600000000000000e+03, 8.5680000000000000e+03, 1.8564000000000000e+04, 3.1824000000000000e+04, 4.3758000000000000e+04, 4.8620000000000000e+04, 4.3758000000000000e+04, 3.1824000000000000e+04, 1.8564000000000000e+04, 8.5680000000000000e+03, 3.0600000000000000e+03, 8.1600000000000000e+02, 1.5300000000000000e+02, 1.8000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 1.9000000000000000e+01, 1.7100000000000000e+02, 9.6900000000000000e+02, 3.8760000000000000e+03, 1.1628000000000000e+04, 2.7132000000000000e+04, 5.0388000000000000e+04, 7.5582000000000000e+04, 9.2378000000000000e+04, 9.2378000000000000e+04, 7.5582000000000000e+04, 5.0388000000000000e+04, 2.7132000000000000e+04, 1.1628000000000000e+04, 3.8760000000000000e+03, 9.6900000000000000e+02, 1.7100000000000000e+02, 1.9000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 2.0000000000000000e+01, 1.9000000000000000e+02, 1.1400000000000000e+03, 4.8450000000000000e+03, 1.5504000000000000e+04, 3.8760000000000000e+04, 7.7520000000000000e+04, 1.2597000000000000e+05, 1.6796000000000000e+05, 1.8475600000000000e+05, 1.6796000000000000e+05, 1.2597000000000000e+05, 7.7520000000000000e+04, 3.8760000000000000e+04, 1.5504000000000000e+04, 4.8450000000000000e+03, 1.1400000000000000e+03, 1.9000000000000000e+02, 2.0000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 2.1000000000000000e+01, 2.1000000000000000e+02, 1.3300000000000000e+03, 5.9850000000000000e+03, 2.0349000000000000e+04, 5.4264000000000000e+04, 1.1628000000000000e+05, 2.0349000000000000e+05, 2.9393000000000000e+05, 3.5271600000000000e+05, 3.5271600000000000e+05, 2.9393000000000000e+05, 2.0349000000000000e+05, 1.1628000000000000e+05, 5.4264000000000000e+04, 2.0349000000000000e+04, 5.9850000000000000e+03, 1.3300000000000000e+03, 2.1000000000000000e+02, 2.1000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 2.2000000000000000e+01, 2.3100000000000000e+02, 1.5400000000000000e+03, 7.3150000000000000e+03, 2.6334000000000000e+04, 7.4613000000000000e+04, 1.7054400000000000e+05, 3.1977000000000000e+05, 4.9742000000000000e+05, 6.4664600000000000e+05, 7.0543200000000000e+05, 6.4664600000000000e+05, 4.9742000000000000e+05, 3.1977000000000000e+05, 1.7054400000000000e+05, 7.4613000000000000e+04, 2.6334000000000000e+04, 7.3150000000000000e+03, 1.5400000000000000e+03, 2.3100000000000000e+02, 2.2000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 2.3000000000000000e+01, 2.5300000000000000e+02, 1.7710000000000000e+03, 8.8550000000000000e+03, 3.3649000000000000e+04, 1.0094700000000000e+05, 2.4515700000000000e+05, 4.9031400000000000e+05, 8.1719000000000000e+05, 1.1440660000000000e+06, 1.3520780000000000e+06, 1.3520780000000000e+06, 1.1440660000000000e+06, 8.1719000000000000e+05, 4.9031400000000000e+05, 2.4515700000000000e+05, 1.0094700000000000e+05, 3.3649000000000000e+04, 8.8550000000000000e+03, 1.7710000000000000e+03, 2.5300000000000000e+02, 2.3000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 2.4000000000000000e+01, 2.7600000000000000e+02, 2.0240000000000000e+03, 1.0626000000000000e+04, 4.2504000000000000e+04, 1.3459600000000000e+05, 3.4610400000000000e+05, 7.3547100000000000e+05, 1.3075040000000000e+06, 1.9612560000000000e+06, 2.4961440000000000e+06, 2.7041560000000000e+06, 2.4961440000000000e+06, 1.9612560000000000e+06, 1.3075040000000000e+06, 7.3547100000000000e+05, 3.4610400000000000e+05, 1.3459600000000000e+05, 4.2504000000000000e+04, 1.0626000000000000e+04, 2.0240000000000000e+03, 2.7600000000000000e+02, 2.4000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 2.5000000000000000e+01, 3.0000000000000000e+02, 2.3000000000000000e+03, 1.2650000000000000e+04, 5.3130000000000000e+04, 1.7710000000000000e+05, 4.8070000000000000e+05, 1.0815750000000000e+06, 2.0429750000000000e+06, 3.2687600000000000e+06, 4.4574000000000000e+06, 5.2003000000000000e+06, 5.2003000000000000e+06, 4.4574000000000000e+06, 3.2687600000000000e+06, 2.0429750000000000e+06, 1.0815750000000000e+06, 4.8070000000000000e+05, 1.7710000000000000e+05, 5.3130000000000000e+04, 1.2650000000000000e+04, 2.3000000000000000e+03, 3.0000000000000000e+02, 2.5000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 2.6000000000000000e+01, 3.2500000000000000e+02, 2.6000000000000000e+03, 1.4950000000000000e+04, 6.5780000000000000e+04, 2.3023000000000000e+05, 6.5780000000000000e+05, 1.5622750000000000e+06, 3.1245500000000000e+06, 5.3117350000000000e+06, 7.7261600000000000e+06, 9.6577000000000000e+06, 1.0400600000000000e+07, 9.6577000000000000e+06, 7.7261600000000000e+06, 5.3117350000000000e+06, 3.1245500000000000e+06, 1.5622750000000000e+06, 6.5780000000000000e+05, 2.3023000000000000e+05, 6.5780000000000000e+04, 1.4950000000000000e+04, 2.6000000000000000e+03, 3.2500000000000000e+02, 2.6000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 2.7000000000000000e+01, 3.5100000000000000e+02, 2.9250000000000000e+03, 1.7550000000000000e+04, 8.0730000000000000e+04, 2.9601000000000000e+05, 8.8803000000000000e+05, 2.2200750000000000e+06, 4.6868250000000000e+06, 8.4362850000000000e+06, 1.3037895000000000e+07, 1.7383860000000000e+07, 2.0058300000000000e+07, 2.0058300000000000e+07, 1.7383860000000000e+07, 1.3037895000000000e+07, 8.4362850000000000e+06, 4.6868250000000000e+06, 2.2200750000000000e+06, 8.8803000000000000e+05, 2.9601000000000000e+05, 8.0730000000000000e+04, 1.7550000000000000e+04, 2.9250000000000000e+03, 3.5100000000000000e+02, 2.7000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 2.8000000000000000e+01, 3.7800000000000000e+02, 3.2760000000000000e+03, 2.0475000000000000e+04, 9.8280000000000000e+04, 3.7674000000000000e+05, 1.1840400000000000e+06, 3.1081050000000000e+06, 6.9069000000000000e+06, 1.3123110000000000e+07, 2.1474180000000000e+07, 3.0421755000000000e+07, 3.7442160000000000e+07, 4.0116600000000000e+07, 3.7442160000000000e+07, 3.0421755000000000e+07, 2.1474180000000000e+07, 1.3123110000000000e+07, 6.9069000000000000e+06, 3.1081050000000000e+06, 1.1840400000000000e+06, 3.7674000000000000e+05, 9.8280000000000000e+04, 2.0475000000000000e+04, 3.2760000000000000e+03, 3.7800000000000000e+02, 2.8000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 2.9000000000000000e+01, 4.0600000000000000e+02, 3.6540000000000000e+03, 2.3751000000000000e+04, 1.1875500000000000e+05, 4.7502000000000000e+05, 1.5607800000000000e+06, 4.2921450000000000e+06, 1.0015005000000000e+07, 2.0030010000000000e+07, 3.4597290000000000e+07, 5.1895935000000000e+07, 6.7863915000000000e+07, 7.7558760000000000e+07, 7.7558760000000000e+07, 6.7863915000000000e+07, 5.1895935000000000e+07, 3.4597290000000000e+07, 2.0030010000000000e+07, 1.0015005000000000e+07, 4.2921450000000000e+06, 1.5607800000000000e+06, 4.7502000000000000e+05, 1.1875500000000000e+05, 2.3751000000000000e+04, 3.6540000000000000e+03, 4.0600000000000000e+02, 2.9000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 3.0000000000000000e+01, 4.3500000000000000e+02, 4.0600000000000000e+03, 2.7405000000000000e+04, 1.4250600000000000e+05, 5.9377500000000000e+05, 2.0358000000000000e+06, 5.8529250000000000e+06, 1.4307150000000000e+07, 3.0045015000000000e+07, 5.4627300000000000e+07, 8.6493225000000000e+07, 1.1975985000000000e+08, 1.4542267500000000e+08, 1.5511752000000000e+08, 1.4542267500000000e+08, 1.1975985000000000e+08, 8.6493225000000000e+07, 5.4627300000000000e+07, 3.0045015000000000e+07, 1.4307150000000000e+07, 5.8529250000000000e+06, 2.0358000000000000e+06, 5.9377500000000000e+05, 1.4250600000000000e+05, 2.7405000000000000e+04, 4.0600000000000000e+03, 4.3500000000000000e+02, 3.0000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 3.1000000000000000e+01, 4.6500000000000000e+02, 4.4950000000000000e+03, 3.1465000000000000e+04, 1.6991100000000000e+05, 7.3628100000000000e+05, 2.6295750000000000e+06, 7.8887250000000000e+06, 2.0160075000000000e+07, 4.4352165000000000e+07, 8.4672315000000000e+07, 1.4112052500000000e+08, 2.0625307500000000e+08, 2.6518252500000000e+08, 3.0054019500000000e+08, 3.0054019500000000e+08, 2.6518252500000000e+08, 2.0625307500000000e+08, 1.4112052500000000e+08, 8.4672315000000000e+07, 4.4352165000000000e+07, 2.0160075000000000e+07, 7.8887250000000000e+06, 2.6295750000000000e+06, 7.3628100000000000e+05, 1.6991100000000000e+05, 3.1465000000000000e+04, 4.4950000000000000e+03, 4.6500000000000000e+02, 3.1000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 3.2000000000000000e+01, 4.9600000000000000e+02, 4.9600000000000000e+03, 3.5960000000000000e+04, 2.0137600000000000e+05, 9.0619200000000000e+05, 3.3658560000000000e+06, 1.0518300000000000e+07, 2.8048800000000000e+07, 6.4512240000000000e+07, 1.2902448000000000e+08, 2.2579284000000000e+08, 3.4737360000000000e+08, 4.7143560000000000e+08, 5.6572272000000000e+08, 6.0108039000000000e+08, 5.6572272000000000e+08, 4.7143560000000000e+08, 3.4737360000000000e+08, 2.2579284000000000e+08, 1.2902448000000000e+08, 6.4512240000000000e+07, 2.8048800000000000e+07, 1.0518300000000000e+07, 3.3658560000000000e+06, 9.0619200000000000e+05, 2.0137600000000000e+05, 3.5960000000000000e+04, 4.9600000000000000e+03, 4.9600000000000000e+02, 3.2000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 3.3000000000000000e+01, 5.2800000000000000e+02, 5.4560000000000000e+03, 4.0920000000000000e+04, 2.3733600000000000e+05, 1.1075680000000000e+06, 4.2720480000000000e+06, 1.3884156000000000e+07, 3.8567100000000000e+07, 9.2561040000000000e+07, 1.9353672000000000e+08, 3.5481732000000000e+08, 5.7316644000000000e+08, 8.1880920000000000e+08, 1.0371583200000000e+09, 1.1668031100000000e+09, 1.1668031100000000e+09, 1.0371583200000000e+09, 8.1880920000000000e+08, 5.7316644000000000e+08, 3.5481732000000000e+08, 1.9353672000000000e+08, 9.2561040000000000e+07, 3.8567100000000000e+07, 1.3884156000000000e+07, 4.2720480000000000e+06, 1.1075680000000000e+06, 2.3733600000000000e+05, 4.0920000000000000e+04, 5.4560000000000000e+03, 5.2800000000000000e+02, 3.3000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 3.4000000000000000e+01, 5.6100000000000000e+02, 5.9840000000000000e+03, 4.6376000000000000e+04, 2.7825600000000000e+05, 1.3449040000000000e+06, 5.3796160000000000e+06, 1.8156204000000000e+07, 5.2451256000000000e+07, 1.3112814000000000e+08, 2.8609776000000000e+08, 5.4835404000000000e+08, 9.2798376000000000e+08, 1.3919756400000000e+09, 1.8559675200000000e+09, 2.2039614300000000e+09, 2.3336062200000000e+09, 2.2039614300000000e+09, 1.8559675200000000e+09, 1.3919756400000000e+09, 9.2798376000000000e+08, 5.4835404000000000e+08, 2.8609776000000000e+08, 1.3112814000000000e+08, 5.2451256000000000e+07, 1.8156204000000000e+07, 5.3796160000000000e+06, 1.3449040000000000e+06, 2.7825600000000000e+05, 4.6376000000000000e+04, 5.9840000000000000e+03, 5.6100000000000000e+02, 3.4000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 3.5000000000000000e+01, 5.9500000000000000e+02, 6.5450000000000000e+03, 5.2360000000000000e+04, 3.2463200000000000e+05, 1.6231600000000000e+06, 6.7245200000000000e+06, 2.3535820000000000e+07, 7.0607460000000000e+07, 1.8357939600000000e+08, 4.1722590000000000e+08, 8.3445180000000000e+08, 1.4763378000000000e+09, 2.3199594000000000e+09, 3.2479431600000000e+09, 4.0599289500000000e+09, 4.5375676500000000e+09, 4.5375676500000000e+09, 4.0599289500000000e+09, 3.2479431600000000e+09, 2.3199594000000000e+09, 1.4763378000000000e+09, 8.3445180000000000e+08, 4.1722590000000000e+08, 1.8357939600000000e+08, 7.0607460000000000e+07, 2.3535820000000000e+07, 6.7245200000000000e+06, 1.6231600000000000e+06, 3.2463200000000000e+05, 5.2360000000000000e+04, 6.5450000000000000e+03, 5.9500000000000000e+02, 3.5000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 3.6000000000000000e+01, 6.3000000000000000e+02, 7.1400000000000000e+03, 5.8905000000000000e+04, 3.7699200000000000e+05, 1.9477920000000000e+06, 8.3476800000000000e+06, 3.0260340000000000e+07, 9.4143280000000000e+07, 2.5418685600000000e+08, 6.0080529600000000e+08, 1.2516777000000000e+09, 2.3107896000000000e+09, 3.7962972000000000e+09, 5.5679025600000000e+09, 7.3078721100000000e+09, 8.5974966000000000e+09, 9.0751353000000000e+09, 8.5974966000000000e+09, 7.3078721100000000e+09, 5.5679025600000000e+09, 3.7962972000000000e+09, 2.3107896000000000e+09, 1.2516777000000000e+09, 6.0080529600000000e+08, 2.5418685600000000e+08, 9.4143280000000000e+07, 3.0260340000000000e+07, 8.3476800000000000e+06, 1.9477920000000000e+06, 3.7699200000000000e+05, 5.8905000000000000e+04, 7.1400000000000000e+03, 6.3000000000000000e+02, 3.6000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 3.7000000000000000e+01, 6.6600000000000000e+02, 7.7700000000000000e+03, 6.6045000000000000e+04, 4.3589700000000000e+05, 2.3247840000000000e+06, 1.0295472000000000e+07, 3.8608020000000000e+07, 1.2440362000000000e+08, 3.4833013600000000e+08, 8.5499215200000000e+08, 1.8524829960000000e+09, 3.5624673000000000e+09, 6.1070868000000000e+09, 9.3641997600000000e+09, 1.2875774670000000e+10, 1.5905368710000000e+10, 1.7672631900000000e+10, 1.7672631900000000e+10, 1.5905368710000000e+10, 1.2875774670000000e+10, 9.3641997600000000e+09, 6.1070868000000000e+09, 3.5624673000000000e+09, 1.8524829960000000e+09, 8.5499215200000000e+08, 3.4833013600000000e+08, 1.2440362000000000e+08, 3.8608020000000000e+07, 1.0295472000000000e+07, 2.3247840000000000e+06, 4.3589700000000000e+05, 6.6045000000000000e+04, 7.7700000000000000e+03, 6.6600000000000000e+02, 3.7000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 3.8000000000000000e+01, 7.0300000000000000e+02, 8.4360000000000000e+03, 7.3815000000000000e+04, 5.0194200000000000e+05, 2.7606810000000000e+06, 1.2620256000000000e+07, 4.8903492000000000e+07, 1.6301164000000000e+08, 4.7273375600000000e+08, 1.2033222880000000e+09, 2.7074751480000000e+09, 5.4149502960000000e+09, 9.6695541000000000e+09, 1.5471286560000000e+10, 2.2239974430000000e+10, 2.8781143380000000e+10, 3.3578000610000000e+10, 3.5345263800000000e+10, 3.3578000610000000e+10, 2.8781143380000000e+10, 2.2239974430000000e+10, 1.5471286560000000e+10, 9.6695541000000000e+09, 5.4149502960000000e+09, 2.7074751480000000e+09, 1.2033222880000000e+09, 4.7273375600000000e+08, 1.6301164000000000e+08, 4.8903492000000000e+07, 1.2620256000000000e+07, 2.7606810000000000e+06, 5.0194200000000000e+05, 7.3815000000000000e+04, 8.4360000000000000e+03, 7.0300000000000000e+02, 3.8000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 3.9000000000000000e+01, 7.4100000000000000e+02, 9.1390000000000000e+03, 8.2251000000000000e+04, 5.7575700000000000e+05, 3.2626230000000000e+06, 1.5380937000000000e+07, 6.1523748000000000e+07, 2.1191513200000000e+08, 6.3574539600000000e+08, 1.6760560440000000e+09, 3.9107974360000000e+09, 8.1224254440000000e+09, 1.5084504396000000e+10, 2.5140840660000000e+10, 3.7711260990000000e+10, 5.1021117810000000e+10, 6.2359143990000000e+10, 6.8923264410000000e+10, 6.8923264410000000e+10, 6.2359143990000000e+10, 5.1021117810000000e+10, 3.7711260990000000e+10, 2.5140840660000000e+10, 1.5084504396000000e+10, 8.1224254440000000e+09, 3.9107974360000000e+09, 1.6760560440000000e+09, 6.3574539600000000e+08, 2.1191513200000000e+08, 6.1523748000000000e+07, 1.5380937000000000e+07, 3.2626230000000000e+06, 5.7575700000000000e+05, 8.2251000000000000e+04, 9.1390000000000000e+03, 7.4100000000000000e+02, 3.9000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 4.0000000000000000e+01, 7.8000000000000000e+02, 9.8800000000000000e+03, 9.1390000000000000e+04, 6.5800800000000000e+05, 3.8383800000000000e+06, 1.8643560000000000e+07, 7.6904685000000000e+07, 2.7343888000000000e+08, 8.4766052800000000e+08, 2.3118014400000000e+09, 5.5868534800000000e+09, 1.2033222880000000e+10, 2.3206929840000000e+10, 4.0225345056000000e+10, 6.2852101650000000e+10, 8.8732378800000000e+10, 1.1338026180000000e+11, 1.3128240840000000e+11, 1.3784652882000000e+11, 1.3128240840000000e+11, 1.1338026180000000e+11, 8.8732378800000000e+10, 6.2852101650000000e+10, 4.0225345056000000e+10, 2.3206929840000000e+10, 1.2033222880000000e+10, 5.5868534800000000e+09, 2.3118014400000000e+09, 8.4766052800000000e+08, 2.7343888000000000e+08, 7.6904685000000000e+07, 1.8643560000000000e+07, 3.8383800000000000e+06, 6.5800800000000000e+05, 9.1390000000000000e+04, 9.8800000000000000e+03, 7.8000000000000000e+02, 4.0000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 4.1000000000000000e+01, 8.2000000000000000e+02, 1.0660000000000000e+04, 1.0127000000000000e+05, 7.4939800000000000e+05, 4.4963880000000000e+06, 2.2481940000000000e+07, 9.5548245000000000e+07, 3.5034356500000000e+08, 1.1210994080000000e+09, 3.1594619680000000e+09, 7.8986549200000000e+09, 1.7620076360000000e+10, 3.5240152720000000e+10, 6.3432274896000000e+10, 1.0307744670600000e+11, 1.5158448045000000e+11, 2.0211264060000000e+11, 2.4466267020000000e+11, 2.6912893722000000e+11, 2.6912893722000000e+11, 2.4466267020000000e+11, 2.0211264060000000e+11, 1.5158448045000000e+11, 1.0307744670600000e+11, 6.3432274896000000e+10, 3.5240152720000000e+10, 1.7620076360000000e+10, 7.8986549200000000e+09, 3.1594619680000000e+09, 1.1210994080000000e+09, 3.5034356500000000e+08, 9.5548245000000000e+07, 2.2481940000000000e+07, 4.4963880000000000e+06, 7.4939800000000000e+05, 1.0127000000000000e+05, 1.0660000000000000e+04, 8.2000000000000000e+02, 4.1000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 4.2000000000000000e+01, 8.6100000000000000e+02, 1.1480000000000000e+04, 1.1193000000000000e+05, 8.5066800000000000e+05, 5.2457860000000000e+06, 2.6978328000000000e+07, 1.1803018500000000e+08, 4.4589181000000000e+08, 1.4714429730000000e+09, 4.2805613760000000e+09, 1.1058116888000000e+10, 2.5518731280000000e+10, 5.2860229080000000e+10, 9.8672427616000000e+10, 1.6650972160200000e+11, 2.5466192715600000e+11, 3.5369712105000000e+11, 4.4677531080000000e+11, 5.1379160742000000e+11, 5.3825787444000000e+11, 5.1379160742000000e+11, 4.4677531080000000e+11, 3.5369712105000000e+11, 2.5466192715600000e+11, 1.6650972160200000e+11, 9.8672427616000000e+10, 5.2860229080000000e+10, 2.5518731280000000e+10, 1.1058116888000000e+10, 4.2805613760000000e+09, 1.4714429730000000e+09, 4.4589181000000000e+08, 1.1803018500000000e+08, 2.6978328000000000e+07, 5.2457860000000000e+06, 8.5066800000000000e+05, 1.1193000000000000e+05, 1.1480000000000000e+04, 8.6100000000000000e+02, 4.2000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 4.3000000000000000e+01, 9.0300000000000000e+02, 1.2341000000000000e+04, 1.2341000000000000e+05, 9.6259800000000000e+05, 6.0964540000000000e+06, 3.2224114000000000e+07, 1.4500851300000000e+08, 5.6392199500000000e+08, 1.9173347830000000e+09, 5.7520043490000000e+09, 1.5338678264000000e+10, 3.6576848168000000e+10, 7.8378960360000000e+10, 1.5153265669600000e+11, 2.6518214921800000e+11, 4.2117164875800000e+11, 6.0835904820600000e+11, 8.0047243185000000e+11, 9.6056691822000000e+11, 1.0520494818600000e+12, 1.0520494818600000e+12, 9.6056691822000000e+11, 8.0047243185000000e+11, 6.0835904820600000e+11, 4.2117164875800000e+11, 2.6518214921800000e+11, 1.5153265669600000e+11, 7.8378960360000000e+10, 3.6576848168000000e+10, 1.5338678264000000e+10, 5.7520043490000000e+09, 1.9173347830000000e+09, 5.6392199500000000e+08, 1.4500851300000000e+08, 3.2224114000000000e+07, 6.0964540000000000e+06, 9.6259800000000000e+05, 1.2341000000000000e+05, 1.2341000000000000e+04, 9.0300000000000000e+02, 4.3000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 4.4000000000000000e+01, 9.4600000000000000e+02, 1.3244000000000000e+04, 1.3575100000000000e+05, 1.0860080000000000e+06, 7.0590520000000000e+06, 3.8320568000000000e+07, 1.7723262700000000e+08, 7.0893050800000000e+08, 2.4812567780000000e+09, 7.6693391320000000e+09, 2.1090682613000000e+10, 5.1915526432000000e+10, 1.1495580852800000e+11, 2.2991161705600000e+11, 4.1671480591400000e+11, 6.8635379797600000e+11, 1.0295306969640000e+12, 1.4088314800560000e+12, 1.7610393500700000e+12, 2.0126164000800000e+12, 2.1040989637200000e+12, 2.0126164000800000e+12, 1.7610393500700000e+12, 1.4088314800560000e+12, 1.0295306969640000e+12, 6.8635379797600000e+11, 4.1671480591400000e+11, 2.2991161705600000e+11, 1.1495580852800000e+11, 5.1915526432000000e+10, 2.1090682613000000e+10, 7.6693391320000000e+09, 2.4812567780000000e+09, 7.0893050800000000e+08, 1.7723262700000000e+08, 3.8320568000000000e+07, 7.0590520000000000e+06, 1.0860080000000000e+06, 1.3575100000000000e+05, 1.3244000000000000e+04, 9.4600000000000000e+02, 4.4000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 4.5000000000000000e+01, 9.9000000000000000e+02, 1.4190000000000000e+04, 1.4899500000000000e+05, 1.2217590000000000e+06, 8.1450600000000000e+06, 4.5379620000000000e+07, 2.1555319500000000e+08, 8.8616313500000000e+08, 3.1901872860000000e+09, 1.0150595910000000e+10, 2.8760021745000000e+10, 7.3006209045000000e+10, 1.6687133496000000e+11, 3.4486742558400000e+11, 6.4662642297000000e+11, 1.1030686038900000e+12, 1.7158844949400000e+12, 2.4383621770200000e+12, 3.1698708301260000e+12, 3.7736557501500000e+12, 4.1167153638000000e+12, 4.1167153638000000e+12, 3.7736557501500000e+12, 3.1698708301260000e+12, 2.4383621770200000e+12, 1.7158844949400000e+12, 1.1030686038900000e+12, 6.4662642297000000e+11, 3.4486742558400000e+11, 1.6687133496000000e+11, 7.3006209045000000e+10, 2.8760021745000000e+10, 1.0150595910000000e+10, 3.1901872860000000e+09, 8.8616313500000000e+08, 2.1555319500000000e+08, 4.5379620000000000e+07, 8.1450600000000000e+06, 1.2217590000000000e+06, 1.4899500000000000e+05, 1.4190000000000000e+04, 9.9000000000000000e+02, 4.5000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 4.6000000000000000e+01, 1.0350000000000000e+03, 1.5180000000000000e+04, 1.6318500000000000e+05, 1.3707540000000000e+06, 9.3668190000000000e+06, 5.3524680000000000e+07, 2.6093281500000000e+08, 1.1017163300000000e+09, 4.0763504210000000e+09, 1.3340783196000000e+10, 3.8910617655000000e+10, 1.0176623079000000e+11, 2.3987754400500000e+11, 5.1173876054400000e+11, 9.9149384855400000e+11, 1.7496950268600000e+12, 2.8189530988300000e+12, 4.1542466719600000e+12, 5.6082330071460000e+12, 6.9435265802760000e+12, 7.8903711139500000e+12, 8.2334307276000000e+12, 7.8903711139500000e+12, 6.9435265802760000e+12, 5.6082330071460000e+12, 4.1542466719600000e+12, 2.8189530988300000e+12, 1.7496950268600000e+12, 9.9149384855400000e+11, 5.1173876054400000e+11, 2.3987754400500000e+11, 1.0176623079000000e+11, 3.8910617655000000e+10, 1.3340783196000000e+10, 4.0763504210000000e+09, 1.1017163300000000e+09, 2.6093281500000000e+08, 5.3524680000000000e+07, 9.3668190000000000e+06, 1.3707540000000000e+06, 1.6318500000000000e+05, 1.5180000000000000e+04, 1.0350000000000000e+03, 4.6000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 4.7000000000000000e+01, 1.0810000000000000e+03, 1.6215000000000000e+04, 1.7836500000000000e+05, 1.5339390000000000e+06, 1.0737573000000000e+07, 6.2891499000000000e+07, 3.1445749500000000e+08, 1.3626491450000000e+09, 5.1780667510000000e+09, 1.7417133617000000e+10, 5.2251400851000000e+10, 1.4067684844500000e+11, 3.4164377479500000e+11, 7.5161630454900000e+11, 1.5032326090980000e+12, 2.7411888754140000e+12, 4.5686481256900000e+12, 6.9731997707900000e+12, 9.7624796791060000e+12, 1.2551759587422000e+13, 1.4833897694226000e+13, 1.6123801841550000e+13, 1.6123801841550000e+13, 1.4833897694226000e+13, 1.2551759587422000e+13, 9.7624796791060000e+12, 6.9731997707900000e+12, 4.5686481256900000e+12, 2.7411888754140000e+12, 1.5032326090980000e+12, 7.5161630454900000e+11, 3.4164377479500000e+11, 1.4067684844500000e+11, 5.2251400851000000e+10, 1.7417133617000000e+10, 5.1780667510000000e+09, 1.3626491450000000e+09, 3.1445749500000000e+08, 6.2891499000000000e+07, 1.0737573000000000e+07, 1.5339390000000000e+06, 1.7836500000000000e+05, 1.6215000000000000e+04, 1.0810000000000000e+03, 4.7000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 4.8000000000000000e+01, 1.1280000000000000e+03, 1.7296000000000000e+04, 1.9458000000000000e+05, 1.7123040000000000e+06, 1.2271512000000000e+07, 7.3629072000000000e+07, 3.7734899400000000e+08, 1.6771066400000000e+09, 6.5407158960000000e+09, 2.2595200368000000e+10, 6.9668534468000000e+10, 1.9292824929600000e+11, 4.8232062324000000e+11, 1.0932600793440000e+12, 2.2548489136470000e+12, 4.2444214845120000e+12, 7.3098370011040000e+12, 1.1541847896480000e+13, 1.6735679449896000e+13, 2.2314239266528000e+13, 2.7385657281648000e+13, 3.0957699535776000e+13, 3.2247603683100000e+13, 3.0957699535776000e+13, 2.7385657281648000e+13, 2.2314239266528000e+13, 1.6735679449896000e+13, 1.1541847896480000e+13, 7.3098370011040000e+12, 4.2444214845120000e+12, 2.2548489136470000e+12, 1.0932600793440000e+12, 4.8232062324000000e+11, 1.9292824929600000e+11, 6.9668534468000000e+10, 2.2595200368000000e+10, 6.5407158960000000e+09, 1.6771066400000000e+09, 3.7734899400000000e+08, 7.3629072000000000e+07, 1.2271512000000000e+07, 1.7123040000000000e+06, 1.9458000000000000e+05, 1.7296000000000000e+04, 1.1280000000000000e+03, 4.8000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 4.9000000000000000e+01, 1.1760000000000000e+03, 1.8424000000000000e+04, 2.1187600000000000e+05, 1.9068840000000000e+06, 1.3983816000000000e+07, 8.5900584000000000e+07, 4.5097806600000000e+08, 2.0544556340000000e+09, 8.2178225360000000e+09, 2.9135916264000000e+10, 9.2263734836000000e+10, 2.6259678376400000e+11, 6.7524887253600000e+11, 1.5755807025840000e+12, 3.3481089929910000e+12, 6.4992703981590000e+12, 1.1554258485616000e+13, 1.8851684897584000e+13, 2.8277527346376000e+13, 3.9049918716424000e+13, 4.9699896548176000e+13, 5.8343356817424000e+13, 6.3205303218876000e+13, 6.3205303218876000e+13, 5.8343356817424000e+13, 4.9699896548176000e+13, 3.9049918716424000e+13, 2.8277527346376000e+13, 1.8851684897584000e+13, 1.1554258485616000e+13, 6.4992703981590000e+12, 3.3481089929910000e+12, 1.5755807025840000e+12, 6.7524887253600000e+11, 2.6259678376400000e+11, 9.2263734836000000e+10, 2.9135916264000000e+10, 8.2178225360000000e+09, 2.0544556340000000e+09, 4.5097806600000000e+08, 8.5900584000000000e+07, 1.3983816000000000e+07, 1.9068840000000000e+06, 2.1187600000000000e+05, 1.8424000000000000e+04, 1.1760000000000000e+03, 4.9000000000000000e+01, 1.0000000000000000e+00, },
        {1.0000000000000000e+00, 5.0000000000000000e+01, 1.2250000000000000e+03, 1.9600000000000000e+04, 2.3030000000000000e+05, 2.1187600000000000e+06, 1.5890700000000000e+07, 9.9884400000000000e+07, 5.3687865000000000e+08, 2.5054337000000000e+09, 1.0272278170000000e+10, 3.7353738800000000e+10, 1.2139965110000000e+11, 3.5486051860000000e+11, 9.3784565630000000e+11, 2.2508295751200000e+12, 4.9236896955750000e+12, 9.8473793911500000e+12, 1.8053528883775000e+13, 3.0405943383200000e+13, 4.7129212243960000e+13, 6.7327446062800000e+13, 8.8749815264600000e+13, 1.0804325336560000e+14, 1.2154866003630000e+14, 1.2641060643775200e+14, 1.2154866003630000e+14, 1.0804325336560000e+14, 8.8749815264600000e+13, 6.7327446062800000e+13, 4.7129212243960000e+13, 3.0405943383200000e+13, 1.8053528883775000e+13, 9.8473793911500000e+12, 4.9236896955750000e+12, 2.2508295751200000e+12, 9.3784565630000000e+11, 3.5486051860000000e+11, 1.2139965110000000e+11, 3.7353738800000000e+10, 1.0272278170000000e+10, 2.5054337000000000e+09, 5.3687865000000000e+08, 9.9884400000000000e+07, 1.5890700000000000e+07, 2.1187600000000000e+06, 2.3030000000000000e+05, 1.9600000000000000e+04, 1.2250000000000000e+03, 5.0000000000000000e+01, 1.0000000000000000e+00, },
    };

    return combinationList[n][k];
}

double semifactorial(std::int64_t n) {
    assert(n >= SemifactorialMinN);
    assert(n <= SemifactorialMaxN);

    static const double semifactorialList[] = {
        1.0000000000000000e+00,     // -1!!
        1.0000000000000000e+00,     //  0!!
        1.0000000000000000e+00,     //  1!!
        2.0000000000000000e+00,     //  2!!
        3.0000000000000000e+00,     //  3!!
        8.0000000000000000e+00,     //  4!!
        1.5000000000000000e+01,     //  5!!
        4.8000000000000000e+01,     //  6!!
        1.0500000000000000e+02,     //  7!!
        3.8400000000000000e+02,     //  8!!
        9.4500000000000000e+02,     //  9!!
        3.8400000000000000e+03,     // 10!!
        1.0395000000000000e+04,     // 11!!
        4.6080000000000000e+04,     // 12!!
        1.3513500000000000e+05,     // 13!!
        6.4512000000000000e+05,     // 14!!
        2.0270250000000000e+06,     // 15!!
        1.0321920000000000e+07,     // 16!!
        3.4459425000000000e+07,     // 17!!
        1.8579456000000000e+08,     // 18!!
        6.5472907500000000e+08,     // 19!!
        3.7158912000000000e+09,     // 20!!
        1.3749310575000000e+10,     // 21!!
        8.1749606400000000e+10,     // 22!!
        3.1623414322500000e+11,     // 23!!
        1.9619905536000000e+12,     // 24!!
        7.9058535806250000e+12,     // 25!!
        5.1011754393600000e+13,     // 26!!
        2.1345804667687500e+14,     // 27!!
        1.4283291230208000e+15,     // 28!!
        6.1902833536293750e+15,     // 29!!
        4.2849873690624000e+16,     // 30!!
    };

    return semifactorialList[n - SemifactorialMinN];
}


} // namespace(nhfMath)